

<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [安全设计](#安全设计)
  - [基础概念](#基础概念)
  - [计算机组成](#计算机组成)
    - [CPU](#cpu)
    - [Meltdown(熔毁)和Spectre(幽灵)](#meltdown熔毁和spectre幽灵)
    - [memory](#memory)
    - [硬盘](#硬盘)
    - [显示器](#显示器)
  - [工程建设生命周期和安全需求](#工程建设生命周期和安全需求)
  - [系统架构](#系统架构)
    - [系统安全模式](#系统安全模式)
    - [专用模式:](#专用模式)
    - [系统高级模式:](#系统高级模式)
    - [分割模式:](#分割模式)
    - [多级模式(受控安全模式):](#多级模式受控安全模式)
  - [系统安全架构](#系统安全架构)
    - [TCSEC(可信计算机系统评价标准)](#tcsec可信计算机系统评价标准)
    - [ITSEC](#itsec)
    - [CC(Common Criteria)](#cccommon-criteria)
  - [安全模型](#安全模型)
    - [状态机模块](#状态机模块)
    - [信息流模型](#信息流模型)
    - [非干扰模型](#非干扰模型)
    - [Take-Grant模型](#take-grant模型)
    - [访问控制矩阵](#访问控制矩阵)
    - [Bell-LaPadula](#bell-lapadula)
    - [Biba](#biba)
    - [Clark-Wilson 模型](#clark-wilson-模型)
    - [无干扰方式(onointerference)/Goguen-Meseguer](#无干扰方式onointerferencegoguen-meseguer)
    - [Brewer and Nash/Chinese wall模型](#brewer-and-nashchinese-wall模型)
- [安全评估](#安全评估)
  - [安全需求](#安全需求)
  - [控制选择](#控制选择)
  - [安全能力](#安全能力)
  - [评估与缓解安全架构、设计和解决方案要素](#评估与缓解安全架构设计和解决方案要素)
    - [系统评价方法](#系统评价方法)
        - [TCSEC(橘皮书)](#tcsec橘皮书)
          - [红皮书](#红皮书)
    - [ITSEC](#itsec-1)
    - [CC](#cc)
    - [基于客户端和服务端系统](#基于客户端和服务端系统)
    - [数据库系统](#数据库系统)
    - [分布式系统和端点安全](#分布式系统和端点安全)
    - [网格计算](#网格计算)
    - [对等网络](#对等网络)
    - [web系统的漏洞](#web系统的漏洞)
- [密码学](#密码学)
  - [密码学的基础](#密码学的基础)
  - [早期方案](#早期方案)
    - [移位/置换密码](#移位置换密码)
    - [多表替换 ->密钥长度为短语](#多表替换--密钥长度为短语)
    - [单次密本 (one-time pad / Vernam密码) ->密钥长度为明文长度](#单次密本-one-time-pad--vernam密码--密钥长度为明文长度)
    - [运动密钥密码(running key cipher) 书密码](#运动密钥密码running-key-cipher-书密码)
    - [块密码(block cipher)](#块密码block-cipher)
    - [流密码(stream cipher)](#流密码stream-cipher)
    - [混淆和扩散](#混淆和扩散)
  - [对称](#对称)
    - [DES](#des)
    - [IDEA(国际数据加密算法) -> PGP](#idea国际数据加密算法---pgp)
    - [BlowFish](#blowfish)
    - [RC5](#rc5)
    - [Skipjack](#skipjack)
    - [AES(高级加密算法)](#aes高级加密算法)
  - [密钥生命周期](#密钥生命周期)
  - [非对称(公钥/公平密码)](#非对称公钥公平密码)
    - [RSA 加密和签名](#rsa-加密和签名)
    - [Merkle-Hellman背包](#merkle-hellman背包)
    - [E1 Gamal](#e1-gamal)
    - [椭圆曲线 ECC](#椭圆曲线-ecc)
    - [单向散列](#单向散列)
  - [密码学应用](#密码学应用)
    - [数字签名](#数字签名)
    - [PKI](#pki)
    - [便携设备](#便携设备)
    - [电子邮件](#电子邮件)
      - [PGP(pretty good protect)](#pgppretty-good-protect)
    - [web应用](#web应用)
    - [隐写术和水印](#隐写术和水印)
    - [VPN](#vpn)
    - [联网](#联网)
  - [密钥周期管理](#密钥周期管理)
  - [密码攻击](#密码攻击)
- [物理安全](#物理安全)
  - [站点与设施设计的安全原则](#站点与设施设计的安全原则)
  - [实现站点与设施安全控制 P321](#实现站点与设施安全控制-p321)
  - [配线间/中间布线设施](#配线间中间布线设施)
  - [服务器/数据中心](#服务器数据中心)
  - [介质存储设施](#介质存储设施)
  - [证据存储](#证据存储)
  - [受限区与工作区安全](#受限区与工作区安全)
  - [基础设施与HVAC](#基础设施与hvac)
  - [环境问题](#环境问题)
    - [火灾预防、探测与消防](#火灾预防探测与消防)
  - [物理安全的实现与管理](#物理安全的实现与管理)
    - [内部控制](#内部控制)
      - [嵌入式和物联网系统](#嵌入式和物联网系统)
      - [工业控制系统](#工业控制系统)
      - [移动系统](#移动系统)
        - [保护方案](#保护方案)
      - [应用安全](#应用安全)
        - [基本安全保护机制](#基本安全保护机制)
      - [常见的框架问题](#常见的框架问题)

<!-- /code_chunk_output -->

# 安全设计

使用安全设计原则来实施和管理工程的过程
传递信任是一个严重安全问题

- 有边界
- 有访问控制
- 内部安全实现
- 安全审计

身份认证和访问类，对主体验证、权限控制
信息的安全性，机密性、完整性、可用性
边界隔离类，边界和隔离机制，来限制访问、使用等行为的技术
审查类，进行监测、检测和分析的相关技术机制

## 基础概念

进程限制(Confinement)->沙箱
界限(Bound)->用户和内核
隔离(isolation)->隔离是一个稳定的操作系统的重要组成部分
控制->强制访问控制(MAC)和自主访问控制(DAC)
MAC->是否许可一个访问由主体和客体的静态属性决定的
DAC->主体具有一些定义要访问的客体的能力，允许主体根据需要定义要访问的客体列表，基于主体身份，可以允许主体添加或修改对客体的访问规则
信任和保证
可信系统->指所有保护机制协同工作的系统，为许多类型的用户处理敏感数据，同时维护稳定和安全的计算环境。
保证->满足安全需求的可信程度
变化往往是安全的对立面，它经常会降低安全性。因此有重大变更后，需要重新评估系统。


## 计算机组成

计算机硬件: cpu、memory、I/o、devices、bus
### CPU
多任务:单核多任务系统能在任意给定时间处理多个任务或进程
多程序
多核:
多处理:多个CPU的系统，利用多个处理器的处理能力来完成多线程应用程序的执行
SMP(Symmetric Multiprocessing):不仅共享通用操作系统，还共享通用数据总线和内存资源
MMP(Massively parallel processing):支持科学家和数学家研究的计算操作
多进程
多线程:单个进程中执行多个并发任务
内核/用户->特权、监管、系统、内核(环保护)
###保护机制
保护环->ring0,ring3
状态:就绪，等待，运行，监管(特权)、停止

### Meltdown(熔毁)和Spectre(幽灵)
内存错误，导致内存中残留数据处于未受保护的状态
Meltdown->非特权进程读取私有的系统内核内存中的数据
Spectre->从其他正在运行的应用程序中批量窃取内存中的数据


### memory
BIOS存储在EEPROM芯片上，BIOS上的攻击成为phlashing
ROM,PROM,EPROM,EEPROM/UVEPROM(电可擦除)、闪存(边擦边写)
RAM:动态(电容器)和静态(触发器)(断电数据丢失)
寄存器
存储器寻址:寄存器、立即、直接、间接、基址+偏移
辅助存储器->指磁性、光学或基于闪存的介质
### 硬盘
ssd-> 净化、销毁
磁盘-> 擦除(删)、清理（一次写)、清除(多次写)、消磁、销毁
高可用->RAID
RAID1 -> 1:1 备份
RAID5 -> 最少3块，奇偶校验，允许坏1块

### 显示器
TEMPEST(法拉第笼、白噪声)->安全，远程读取电子辐射这个过程称为Van Eck入侵



## 工程建设生命周期和安全需求

需求(安全需求)、设计(安全模型)、开发(安全控制)、测试(安全评估)、上线、运营和退役


根据一组充分考虑和定义的安全设计原则，减少风险
ISO/IEC 19249 
五个框架原则:域隔离、分层、封装、冗余、虚拟化
五个设计原则:最小特权、攻击面最小化、集中参数验证、集中通用安全服务、为错误和异常处理做准备


## 系统架构
### 系统安全模式
专有、系统高级、分割、多级
知其所需(need to know)是指一种访问授权方案

### 专用模式:
- 每个用户必须具有允许访问系统处理的所有信息的安全许可
- 每个用户必须拥有系统处理的所有信息的访问批准
- 每个用户必须有对系统处理的所有信息具有“知其所需”权限

### 系统高级模式:
- 用户->所有信息的有效安全许可
- 用户->所有信息的访问批准
- 用户->某些信息，有效的 知其所需 权限

### 分割模式:
与系统模式区别，不一定具有对系统上所有信息的访问批准

### 多级模式(受控安全模式):
许可、访问批准、知其所需
![](http://my.cdn.lolyzf.cn/uploads/free/202010/08_39_58_81113.png)


## 系统安全架构
### TCSEC(可信计算机系统评价标准)
美国军方

可信计算基（TCB)->硬件、软件和固件
安全边界-> 假想的边界
引用监控器-> 抽象机，中介
安全内核->实现了引用控制器，包括硬件、软件和固件
彩虹系列中的橘皮书，强调的是机密性，共包括4类
A->已验证保护(最高级)
B->强制性保护
C->自主性保护
D->最小保护

### ITSEC
欧洲，首次提出了机密性、完整性、可用性
正式被评估系统作为评估目标(Target Of Evaluation TOE)

### CC(Common Criteria)
又名 ISO 15408
两个要素: 保护轮廓(PP)和安全目标(ST)
PP:要评估的产品（TOE)指定安全要求和保护"客户想要的安全"
ST(Security Targets, ST):安全声明，已实践的安全措施或是供应商的“我将提供的安全”声明
等级EAL(1~7)



## 安全模型
安全策略所需要的数据结构和技术，映射到信息系统的具体内容上，以数学和分析的理论表示，然后映射到系统的规范，编程开发
模型提供了一种形式化安全策略的方法。计算机可遵循这些规则来实现构成安全策略的基础安全概念、过程和程序。

安全令牌(Token)是与资源关联的独立客体，它描述资源的安全属性
能力(Capability)列表为每个受控客体维护一行安全属性信息
安全标签(Label)是第三种常见的属性存储类型，客体的永久部分。提供一种防止篡改的保护措施。

### 状态机模块
状态机模型描述了一个系统，它无论处于什么状态总是安全的。安全状态机:安全状态->安全状态

### 信息流模型
信息流模型基于状态机模型，Bell-LaPadula和Biba模型都是信息流模型。
信息流模型还可以通过明确排除所有非定义流动路径来解决隐蔽通道的问题。

### 非干扰模型
级联
反馈
连接:一个系统将输入发送到另一个系统，但也将输入发送到外部实体

### Take-Grant模型
获取规则
创建规则
授予规则
删除规则

### 访问控制矩阵
主体和客体的表

### Bell-LaPadula
知其所需(need-to-know):仅当特定工作任务需要这种访问时，才授予对特定客体的分类级别的访问权限
多级、算术、状态/信息流、访问的模式、机密性
- 简单安全规则(不能向上读)
- 星属性规则(不能向下写/限制属性)
- 强星属性规则
只能在一个等级读写
- 自主安全属性
控制矩阵->白名单 来打破上面的三条规则

### Biba
信息流、多级别模型
关注数据的完整性
- 简单完整性 (不能向下读)
- 星完整性(不能向上写)
- 调用属性规则 
主体不能调用/请求完整性级别更高的主体的服务

### Clark-Wilson 模型
关注完整性，更多应用在商业场景
专注结构良好的事务处理(从一个一致状态转换为另一个一致状态的一系列操作)和职能划分，
访问客体只能通过接口进行访问
![](http://my.cdn.lolyzf.cn/uploads/free/202010/15_41_47_61312.png)
标准格式事务和职责分离

### 无干扰方式(onointerference)/Goguen-Meseguer

多级安全属性
处理隐蔽信道，分为:存储和计时
### Brewer and Nash/Chinese wall模型
不能读取某个数据集的某个客体才能读另一个客体，防止访问有利益冲突的数据
基于先前的活动而动态改变的:数据隔离



# 安全评估
## 安全需求
- 法规
- 威胁
- 风险评估

## 控制选择
ISO 27001->安全管理体系标准
ISO 27002 ->控制措施

## 安全能力
- 封闭/开放
- 内存保护
隔离、虚拟内存、分段、内存管理和保护环

- 虚拟化
一个机器运行多个操作系统，管理技术:Type1 和 Type2

- 可信平台模块
TPM -> 微控制器芯片
把硬盘从原始系统中拿走，则无法对其进行解密


- 硬件安全模块(HSM)
密钥保存

- 智能卡

## 评估与缓解安全架构、设计和解决方案要素
### 系统评价方法
第1阶段-认证:
对 IT 系统以及为支持认可过程而制定的其他保护措施的技术和非技术安全功能的综合评估，从而确定特定设计和实施满足一组特定安全要求的程度

系统认证是对计算机系统各个部分的技术评估，以评估其与安全标准的一致性
评估所有控件，包括管理性的、技术性和物理性控制

验证过程与认证过程类似，因为它验证了安全控制。通过涉及第三方测试服务和得出广为信任的结果，验证可以进一步进行。通过鉴定环节表明管理层正式接受了该评估系统。

第2阶段-认可:
是管理层对系统整体安全和功能的充分性的正式认定.提交到管理层对报告进行决定是否可以接受。
邀请第三方来执行评价，批准印章(即系统符合所有基本标准)

鉴定是指定审批机构(DAA)正式声明:IT系统被批准在特定安全模式下使用规定的一套保障措施在可接受的风险水平下运行。


TCSEC、ITSEC、CC
##### TCSEC(橘皮书)
授权用户无法受到约束

适用于不联网的独立系统
![](http://my.cdn.lolyzf.cn/uploads/free/202010/04_36_02_75775.png)
B类控制提供标签的
A类系统最高要求，处理绝密数据
###### 红皮书
在网络环境中，阐述TCSEC，主要功能:保密性和完整性、拒绝服务问题
![](http://my.cdn.lolyzf.cn/uploads/free/202010/04_49_42_50966.png)

### ITSEC
欧洲标准
ITSEC将评估中的系统称为评估目标(TOE)
解决了机密性、完整性、可用性
只需要对变更进行评估即可

### CC
ISO 15408 信息安全技术安全评估标准
已经被CC验证过的系统，不需要重复验证
两个要素:保护范畴(Protection Profile,PP)和安全目标（Security Targets,ST)
PP->为要评估的产品指定安全要求和保护，客户想要的安全
ST->供应商在TOE内构建的安全声明 “我将提供的安全”声明
评估保证级别(Evaluation Assurance Level,EAL)
![](http://my.cdn.lolyzf.cn/uploads/free/202010/05_07_10_11778.png)
cc指南不包括现场评估，即人员、组织实践和过程或物理安全相关的控制，无电磁辐射，加密算法要求

![](http://my.cdn.lolyzf.cn/uploads/free/202010/05_10_19_74025.png)

ISO是全球标准制定组织，六个主要产品:国家标准、技术报告、技术规范、公开可用规范、技术勘误和指南

### 基于客户端和服务端系统
客户端:缺少安全认证机制
服务端:数据流控制方法
本地缓存:ARP(静态)、DNS、Internet文件缓存

### 数据库系统
主键、外键
行->基数，列->度
聚合->低等级事情汇集到一起
推理->可能是同级事情，推断出来的
SQLmap进行安全测试

### 分布式系统和端点安全
分布式系统是一个多台计算机共同完成任务的系统，主要问题:隐私问题、合规困难、开源与封闭式解决方案、开放标准的采用、云的数据是否切实地受到保护

虚拟机管理程序是创建、管理和操作虚拟机的虚拟化组件
虚拟机管理程序:
Type-I是原生或裸机管理程序。
Type-II是托管管理程序。

基础设施即服务（IaaS) 只有硬件无os等
平台即服务(PaaS) os层面
软件即服务(SaaS) 软件层面

私有云是企业内部网络中的云服务并与Internet隔离，仅内部使用
公有云是供公众访问的服务，通常通过Internet连接。
社区云是由一组用户或组织维护、使用和支付用于利益共享的云环境，例如协作和数据交换
云访问安全代理(Cloud Access Security Broker CASB)是一种实施安全策略的解决方案，云解决方案和客户组织之间实施适当的安全措施。

安全即服务(security as service,SECaaS)云提供商概念
网格计算是一种并行分布式处理形式，类似星型结构，存在中间节点故障，节点暴露等问题
对等网络(P2P)技术是网络和分布式应用程序解决方案，可在点对点共享任务和工作负载。主要问题:盗版、窃听、缺乏集中监管和过滤、带宽消耗

弹性是指虚拟化和云解决方案根据需要扩展或收缩的灵活性

快照是虚拟机备份，虚拟化不会降低os的安全，补丁需要

### 网格计算
一种并行分布式处理形式，最大的安全问题是每个工作包的内容可能会暴露给外界，不适用于私有、机密或专有数据

### 对等网络
对等网络(Peer to Peer,P2P)技术是网络和分布式应用解决方案。eg: VoIP、SKype、BitTorrent(用于数据/文件分发)和Spotify(用于流媒体音频/音乐分发)
P2P解决方案包括对盗版材料的感知诱导、窃听分布式内容的能力、缺乏集中控制/监督/管理/过滤以及服务消耗所有可用带宽的可能性

### web系统的漏洞
SAML是一种基于XML的约定,用来组织和交换在安全域之间的用于认证与授权通信的详细信息，通常是web协议。基于web的sso(单点登录)方案

XSRF(Cross-site request forgery)跨站请求伪造 ->Zeus

CAPTCHA是一种区分人类和软件机器人的机制，另一种潜在的保护机制是向每个URL请求和会话建立添加随机化字符串(nonce)





# 密码学

密码学解决的是机密性、完整性、不可否认性、身份认证的基础

## 密码学的基础

- 布尔数学
只有两个值
- And
都为真，才是真
- OR
有一个为真，就是真
- NOT
取反
- XOR
有一个为真的时候才为真
- %
模运行，除数余数
- 单向函数
公钥密码的基础
- None
随机变量、初始化向量(IV)
- 零知识证明 -> 密门实例
不把具体内容告诉第三方，但可以证明你知道这个内容
- 分割知识
一个事情分给多个人做的方案叫分割知识，密钥托管->N分之M理论

- 代价函数
成本/收益，评价加密算法是否足够有效


- 代码和密码
代码作用于单词或短语，密码作用于位

## 早期方案
- 凯撒密码、恺撒变换、变换加密、ROT3 -> 替换密码，固定方式A->D，解密是D->A
- 破解 -> 唯密文攻击 频率分析
### 移位/置换密码
明文必须是密钥的整数倍
A T T A C K E R
1 7 8 2 3 5 4 6
###替换密码
用一个不同字符替换明文消息的每个字符或位
凯撒密码 ROT3 ->密钥长度为1
C = (P + 3 ) mod 26

### 多表替换 ->密钥长度为短语
多表替换系统的最著名的例子 Vigenere密码系统，抵御直接频率分析，但无法抵御周期分析的二阶式频率分析

### 单次密本 (one-time pad / Vernam密码) ->密钥长度为明文长度
为明文消息中的每个字母使用一个不同的替换字母表
C =(P + K) mod 26
优势:使用得当，无法被破解
满足要求: 
每个单次密本必须只使用一次
密钥必须至少与将被加密的消息一样长
物理交换密本

三种替换算法只是密钥长度不同

### 运动密钥密码(running key cipher) 书密码
### 块密码(block cipher)
现代密码算法都执行某类块密码
### 流密码(stream cipher)
一次在消息或消息流的一个字符或一个位上运行
### 混淆和扩散
混淆:明文和密钥之间有着极其复杂的关系，迫使攻击者只靠改动明文和分析结果密文来确定密钥
扩散:明文发生一点变化，密文发生很大变化


公开算法的主张->科克霍夫Kerckhoffs->不公开算法隐匿
加密算法:对称/秘钥/秘密密钥加密算法和非对称/公钥


## 对称

密钥分发/管理是一个缺点，管理复杂 n*(n-1)/2
密钥必须经常重新生成
无法提供不可否认性
对称密钥加密发不提供不可否认性
算法缺乏可伸缩性
速度是快 1000到10000倍


### DES 

密钥是64位(实际使用时56位，8位做奇偶校验)，分组->替代或交换

5中模式:

- 电子密码本(Electronic Code Book, ECB)
最简单 最不安全，可能导致相同明文得到相同密文，会暴露加密模式，不会影响其他分组

- 密码块链接(cipher block chaining,CBC)
使用初始IV,每次明文与前一次密文进行XOR运算
不暴露加密模式，错误会传递

- 密码反馈(Cipher feedback,CFB)
流模式的CBC,也需要IV

- 输出反馈(Output Feedback,OFB)
创建种子值，不会传播错误

- 计数器(counter,CTR)
不会传播错误，多个独立不在，适合平行计算



2DES 不安全，中间相遇，密钥可穷尽

3DES 64（56,112,168）
2个或3个密钥运算三次DES


### IDEA(国际数据加密算法) -> PGP

提高DES密钥，是128位密钥

### BlowFish

BlowFish 可变密钥 32~448，linux的Bcypt

### RC5 
可变块大小(32、64、128)
密钥 0 ~ 2040

### Skipjack
密钥->80位，支持加密密钥托管(NIST,财务部)

### AES(高级加密算法) 

128(10轮)、192(12轮)、256(14轮) -> 微软bitlocker,EFS
加密敏感未分类的数据
Rijndael
Towfish -> 预白化处理/白化后处理

![](http://my.cdn.lolyzf.cn/uploads/free/202010/15_57_19_86613.png)


## 密钥生命周期

- 分发
线下、DH交换、公钥加密
- 存储和销毁
分段存储

会话密钥:一次密钥
DH交换算法: Diffie和Hellman (第一个公钥算法)

代码和密码之间的主要区别是密码是在字符或位这种级别来改变数据，而不 是字级别


## 非对称(公钥/公平密码)

速度慢，密钥统一管理，一个人有两个密钥(公钥和私钥)
公钥加密系统方法会对密钥进行托管，在通信中使用的秘密密钥被分成两个或多个部分，每个部分被给予独立的第三方

### RSA 加密和签名
n = p * q （n是最大的)

### Merkle-Hellman背包 
另一种非对称加密算法，1984年证明不安全
![](http://my.cdn.lolyzf.cn/uploads/free/202010/18_13_47_40207.png)

### E1 Gamal 
基于DH的理论创建的公钥加密算法，无申请专利，但密文比明文长一倍，增加了网络开销
理论基础:标准离散对数

### 椭圆曲线 ECC
椭圆曲线离散对数题是加密基础理论

DSA(只用于签名) -> 椭圆曲线ECC

综合对称和非对称的优缺点产生了数字信封的概念，用非对称加密对称密钥，对称密钥加密数据，统一进行发送，对方先用自己的私钥解密获得对称密钥，在对数据进行解密，获得明文，在速度上是折中方案。


签名算法:不能保证保密性


### 单向散列
相同消息生成相同消息摘要
可用于数字签名

md5 - 16 * 8 = 128
(做成 512-64 长度)

sha1 - 160
sha256 - 256
sha3 ->Keccak算法
HMAC -> 
HAVAL -> 1024位块，产生128、160、192、224、256位散列值
![](http://my.cdn.lolyzf.cn/uploads/free/202010/18_31_59_89950.png)


## 密码学应用 


### 数字签名

RSA、DSA(数字签名算法)、椭圆曲线ECC
散列函数选择SHA-3

### PKI

RA/CA/证书(x509)
申请、颁发、注销(CRL,OCSP)

### 便携设备
硬盘-bitlock,EFS,FileVault,VeraCrypt ->TPM

### 电子邮件
#### PGP(pretty good protect)
商业版:RSA,IDEA,md5
免费版:DH,Carlisle Adams/Stafford Tavares(CAST)128,sha1

- S/MIME(secure/Multipurpose Internet Mail Extensions)
RSA,AES,3DES,X.509证书交换密码密钥

### web应用
HTTPS -> SSL 对poodle攻击比较敏感(中间人，js),TLS
数据信封

### 隐写术和水印
iSteg隐写工具

### VPN
 IPSec （4个SA)
互联网协议安全(IPsec)
VPN -> TLS/IPSEC(AH->身份认证和完整性,不可否认，鉴别和访问控制抵御重放,ESP->加密), L2TP(数链层)/IPSec
ESP有两种模式:
传输模式，只加密数据包载荷
隧道模式，加密包括报头在内的整个数据包，网关和网关的通信设计


### 联网
- 线路
链路加密 所有消息头、消息尾部、地址、路由器都需要加密，每个中继器都需要解密导致传输开销大，比较慢
端到端加密 只加密消息内容



- 无线联网
有线等效保密(Wired Equivalent Privacy ,WEP) 提供64和128位加密选项，802.11 WEP为可选部分
WiFi受保护访问(WPA),以执行临时密钥完整性性协议(TKIP)消除WEP密码缺陷
WPA2使用AES密码
提供的是，手机到AP之间的加密，到达有线后信息变成明文


## 密钥周期管理

创建密钥->分发密钥(传输密钥)->使用密钥/存储密钥(存储的位置，代码写死)->变更密钥(替换密钥往往是最难的，备份数据怎么变更)->密钥销毁

## 密码攻击
唯密文攻击:只有密文
已知明文:知道明文和密文
选择密文:选定密文知道明文
选择明文:知道任何明文对应的密文
差分密码:特定差异的明文进行加密而生成的密文对
线性密码:
中间相遇->两轮加密协议
中间人
代数攻击:对算法自身的脆弱性进行分析
生日攻击 ->碰撞
重放攻击
彩虹表


# 物理安全
物理安全至关重要，是一切安全的基础

## 站点与设施设计的安全原则
关键路径分析:是一项系统性工作，用于找出关键应用、流程、运营以及所有必要支持元素间的关系
站点选择、可见度、自然灾害、设施设计（CPTED)、
CPTED:通过构建物理环境和周边设施，来降低甚至打消潜在入侵者的犯罪企图。

## 实现站点与设施安全控制 P321
控制的功能顺序:
威慑
阻挡
监测
延迟
SLA(Service-Level Agreement)
MTTF(Mean Time To Failure 平均故障时间)
MTTR(Mean Time To Repair 平均恢复时间)
MTBF(Mean Time Between Failures 平均故障间隔时间)


管理、技术与物理(现场)
- 管理类
设施建造与选择
站点管理
人员控制
安全意识培训
应急响应与流程
- 技术类物理安全控制
访问控制
入侵检测
警报
闭路电视监控系统(Closed-Circuit Television, CCTV)
监控
HVAC的电力供应
火警探测与消防
- 现场类
围栏
照明
门锁
建筑材料
捕人陷阱
警犬与警卫

## 配线间/中间布线设施
配线间通常位于不同楼层正对的上下方
普通铜芯双绞线线缆最长有效长度是100米

## 服务器/数据中心
智能卡
入侵检测
访问滥用->伪装，捎带(piggybacking)
发射安全->TEMPEST措施包括:法拉第笼、白噪音与控制区

## 介质存储设施
## 证据存储
## 受限区与工作区安全
墙与隔断->可防止无意的肩窥(shoulder surfing)或偷听行为

## 基础设施与HVAC
UPS
电力:
故障->瞬时断电
停电->完全失去电力供应
电压骤降(sag)->瞬时低电压
低电压(Brownout)->长时低电压

- 温度、湿度与静电
保持在华氏60~75(摄氏 15~23)
湿度 40%~60%
![](http://my.cdn.lolyzf.cn/uploads/free/202011/20_24_52_80099.png)


## 环境问题
### 火灾预防、探测与消防
火灾最主要:火/燃料(碳酸钠及其他干粉)、热量(水)和氧气(二氧化碳、哈龙替代物)
在人类相容环境，首选水，气体更适合没有人员驻守的环境
哈龙->有毒，消耗臭氧和氧气->人危险->>FM-200（HFC-227ea)

火灾探测:
阶段1->空气电离，烟雾产生->烟雾探测器/吸气传感器
阶段2->烟雾->着火点 ->
阶段3->火焰
阶段4->炙热

防火管理中的一个基础是正确的人员防火意识培训，消防原理，逃生通道
数据中心->火灾->电源插座过载引起的
![](http://my.cdn.lolyzf.cn/uploads/free/202011/11_28_24_33396.png)
![](http://my.cdn.lolyzf.cn/uploads/free/202011/11_39_28_10826.png)
喷水灭火系统的最常见故障都是因为人为错误造成的，比如发生火灾了才发现水源关闭了，或没有发生火灾就打开了喷水功能

火灾的破坏包括烟、高温、水或碳酸钠，灭火剂->短路、腐蚀、设备报废
消防人员->水管灭火、救生斧寻找火源


## 物理安全的实现与管理
###　边界安全
1.围栏(Fences)、门(Gates)、旋转门(Turnstiles)与捕人陷阱(mantraps)
2.照明
3.安全警卫与警犬

1英尺~0.3m
3~4->无意穿越
6~7->吓阻入侵者
8->外加三层铁丝网->坚定入侵者

### 内部控制
- 钥匙与密码锁
锁->shimming攻击
- 胸卡、身份卡、安全标识
- 动作探测器
红外
热量
波动->低频超声或高频超声
电容->电场或磁场
光电->可见光级别
被动音频->异常声音
- 入侵警报
阻止警报
驱除警报
通知警报
本地警报系统->声音120分贝->400英尺

- 二次验证机制
CCTV是与动作探测器、传感器以及警报相关的安全技术(非自动化，需要人盯着)
- 环境与生命安全
- 隐私责任与法律要求
- 监管要求


#### 嵌入式和物联网系统
嵌入式可能导致人员伤亡，保护的挑战是软件的安全性
物联网(IoT)->保护 身份验证、数据加密、数据/补丁更新，mirai病毒是IoT病毒的鼻祖
HVAC(Heating，Ventilation And Air Conditioning) 供暖、通风和空调管理

#### 工业控制系统
工业控制系统(ICS)主要包括:可编程逻辑控制器(PLC)、分布式控制系统(DCS)、管理控制和数据采集(SCADA)

#### 移动系统
应用安全方面的选项:密钥管理、地理位置标记、凭据管理、加密、身份认证、应用白名单，移动设备管理(MDM)

BODY(自带设备)数据所有权、隐私、入职/离职、法律问题、摄像头问题

虚拟桌面基础设施(VDI)是一种降低终端设备的安全风险和性能要求的方法
虚拟移动基础设施(VMI)是中央服务器上虚拟化

NFC(近场通信)和RFID(射频识别)
##### 保护方案
- 网络分段
- 安全层
- 应用防火墙
- 手动更新
- 固件版本控制
- 包装器
- 监控
- 控制冗余和多样性


#### 应用安全
- 密钥管理
- 凭据管理
- 身份验证
- 应用白名单

##### 基本安全保护机制
- 技术机制
分层
抽象
数据隐藏
进程隔离
硬件分割
- 策略机制
最小特权
特权分离
问责制

#### 常见的框架问题
隐蔽隧道->时间和存储
时间隐蔽通道 通过改变系统组件性能或以可预测的方式修改资源的时间来传达信息
存储隐蔽通道 将数据写入公共存储区域来传送信息，其中另一个进程可以读取它

维护陷阱/钩子
检验时间/使用时间（TOC/TOU)
增量攻击
-salami 非常小的位数进行攻击
电磁辐射->TEMPEST技术可防止EM辐射窃听，包括法拉第笼(外壳)、干扰或噪音发生器和控制区